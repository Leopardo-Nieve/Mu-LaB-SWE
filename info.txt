2025-06-20

Behaviour is still not physical. 
Outlet condition is now better enforced, but the issue at the inlet is amplified. 
The inlet depth increases until it reaches infinity. Note that the consistency condition is not respected at the inlet. The definite cause remains to be determined.
---

Modifications since last version:
- added consistency check for inlet and outlet boundary conditions. If the consistency condition is verified, then the inlet or outlet equations are valid. Otherwise, the solutions are incorrect.

- used h_out instead of past timestep h to enforce depth at outlet

- added depth to convergence criteria

- added a is_nan verification for ftemp before solution subroutine is called
---

Potential next step(s):
- Assign values to initial mesoscopic populations as well as macroscopic values for inlet and outlet boundary conditions. It may enforce the consistency equation and thus create a physical depth at the inlet.